<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#006655" />
    <meta name="description" content="Have a robot make you a drink">
    <title>Drink Maker 2</title>
    <link rel="manifest" href="manifest.webmanifest">
    <link rel="icon" href="static/icon48.png">
    <link rel="apple-touch-icon" href="static/icon192.png">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@100&display=swap">

    <script type="module">

        function visibility() {
            if (document.hidden) {
                let visibility = {
                    uuid: uuid,
                    type: "hidden"
                };
                socket.send(JSON.stringify(visibility));
                console.log("hidden");
            } else {
                if (socket.readyState == WebSocket.CLOSED) {
                    socketInit();
                }
                let visibility = {
                    uuid: uuid,
                    type: "visible"
                };
                socket.send(JSON.stringify(visibility));
                console.log("visible");
            }
        }

        function socketInit() {
            console.log("socket init");

            socket = new WebSocket("ws://drinkr:8765");

            socket.onopen = function () {
                console.log("socket open");

                let query = {
                    uuid: uuid,
                    type: "query"
                };
                socket.send(JSON.stringify(query));

                document.onvisibilitychange = visibility;
                visibility();

                socketAttempts = 0;

                if (!socketConnected) {
                    socketConnected = true;
                    statusConnection.textContent = "Connected";
                    statusConnection.style.color = "hsl(var(--hue-a), 100%, 40%)";
                }
            }

            socket.onclose = function () {
                console.log("socket close");
                if (socketConnected) {
                    socketConnected = false;
                    statusConnection.textContent = "Disconnected";
                    statusConnection.style.color = "hsl(var(--hue-f), 100%, 40%)";
                }
                let delay = 3000;
                if (socketAttempts == 0) {
                    delay = 0;
                }
                setTimeout(() => {
                    if (socket.readyState == WebSocket.CLOSED) {
                        socketInit();
                    }
                }, delay);

                socketAttempts++;
            }

            socket.onerror = function () {
                console.log("socket error");
                socket.close();
            }

            socket.onmessage = function (event) {
                console.log("socket message");
                let msg = JSON.parse(event.data);
                console.log(msg);
                if (msg.drinks) {

                    drinks = msg.drinks;
                    ingredients = msg.ingredients;

                    for (let name in drinks) {
                        if (drinkElems[name] == null) {

                            drinkElems[name] = new DrinkItem(name, 'drinks');
                            lists['drinks'].append(drinkElems[name]);
                        }

                        drinkElems[name].updateEmpty();
                    }

                    for (let name in ingredients) {
                        if (ingredientElems[name] == null) {

                            ingredientElems[name] = new IngredientItem(name);
                            lists['ingredients'].append(ingredientElems[name]);
                        }

                        ingredientElems[name].updateEmpty();
                    }

                    drinkElems['Custom Drink'].updateEmpty();

                    if (detailElems['drinks'].expanded) {
                        detailElems['drinks'].updateEmpty();
                    }
                    if (detailElems['ingredients'].expanded) {
                        detailElems['ingredients'].updateEmpty();
                    }
                }
                if (msg.status) {

                    if (msg.status.userState != userState) {
                        userState = msg.status.userState;
                        if (detailElems['drinks'].expanded) {
                            detailElems['drinks'].updateButtons();
                        }
                        if (detailElems['ingredients'].expanded) {
                            detailElems['ingredients'].updateButtons();
                        }
                        clearInterval(statusTimer);

                        if (userState == "FRONTLINE") {
                            //msg.status.timer += Date.now()/1000;
                            statusBase.classList.remove("bar-progress");
                            statusBase.classList.add("bar-timer");
                            statusTimer = setInterval(() => {
                                statusTime -= 1;
                                if (statusTime < 0) {
                                    clearInterval(statusTimer);
                                } else {
                                    statusBase.style.transform = "scaleX(" + statusTime * 5 + "%)";
                                }
                            }, 1000);

                            statusButton.classList.remove("grey", "cancel");
                            statusButton.classList.add("pour");
                            statusButton.textContent = "Pour";
                        } else if (userState == "POURING") {
                            statusBase.classList.remove("bar-timer");
                            statusBase.classList.add("bar-progress");

                            statusButton.classList.remove("grey", "pour");
                            statusButton.classList.add("cancel");
                            statusButton.textContent = "Cancel";
                        } else {
                            statusBase.style.transform = "scaleX(0)";

                            statusButton.classList.add("grey");
                            statusButton.classList.remove("cancel", "pour");
                            statusButton.textContent = "Pour";
                        }
                    }
                    if (userState == "FRONTLINE") {
                        statusTime = msg.status.timer;
                        statusBase.style.transform = "scaleX(" + statusTime * 5 + "%)";
                    }
                    if (userState == "POURING") {
                        statusBase.style.transform = "scaleX(" + msg.status.progress + "%)";
                    }

                    if (userState == "INLINE" || userState == "FRONTLINE" || userState == "POURING") {
                        statusQueue.textContent = "Queue: " + msg.status.position + "/" + msg.status.size;
                        statusDrink.textContent = queuedDrink.name;
                        statusOutlet.textContent = queuedDrink.outlet;
                    } else {
                        statusQueue.textContent = "Queue: " + msg.status.size;
                        statusDrink.textContent = "";
                        statusOutlet.textContent = "";
                    }

                    statusState.textContent = msg.status.makerState;
                }
                if (msg.user) {
                    userDrinks.textContent = decimal(msg.user.drinks, 1);
                    userBAC.textContent = decimal(msg.user.bac, 3);

                    userNameInput.value = msg.user.name;
                    userWeightInput.value = msg.user.weight;

                    if (msg.user.name != "") {
                        drinkElems['Custom Drink'].nameElem.textContent = msg.user.name + "'s Drink";
                    } else {
                        drinkElems['Custom Drink'].nameElem.textContent = msg.user.name + "Custom Drink";
                    }


                    userSex = msg.user.sex;
                    if (userSex == "male") {
                        userFemaleButton.classList.remove("active");
                        userMaleButton.classList.add("active");
                    } else if (userSex == "female") {
                        userMaleButton.classList.remove("active");
                        userFemaleButton.classList.add("active");
                    }
                }
            };
        }

        class DrinkItem extends HTMLElement {
            constructor(name, page) {
                super();

                this.appendChild(templateDrinkItem.content.cloneNode(true));

                this.name = name;
                if (drinks[name] != null) {
                    this.ingredients = drinks[name];
                } else {
                    this.ingredients = {};
                }

                this.empty = false;
                this.page = page;

                this.nameElem = this.querySelector(".drink-name");
                this.nameElem.textContent = this.name;

                this.ingredientsElem = this.querySelector(".ingredient-summary");
                this.ingredientsSummary = "";

                this.updateIngredients();

                this.onclick = function () {
                    event.stopPropagation();
                    this.expandDetail(this.name);
                };
            }

            updateEmpty() {
                let empty = false;
                let volume = 0;
                for (let ingredient in this.ingredients) {
                    volume += this.ingredients[ingredient];
                    if (ingredients[ingredient].empty) {
                        empty = true;
                        break;
                    }
                }
                if (volume == 0) {
                    empty = true;
                }

                if (empty && !this.empty) {
                    this.classList.add("drink-empty");
                    this.empty = empty;
                } else if (!empty && this.empty) {
                    this.classList.remove("drink-empty");
                    this.empty = empty;
                }
            }

            updateIngredients() {
                let ingredientSummary = "";
                for (let ingredient in this.ingredients) {
                    ingredientSummary += ingredient + ", "
                }

                if (ingredientSummary != this.ingredientSummary) {
                    this.ingredientSummary = ingredientSummary
                    this.ingredientsElem.textContent = this.ingredientSummary;
                }
            }

            expandDetail() {
                if (detailElems[this.page].expanded) {
                    return;
                }
                detailElems[this.page].expanded = true;

                detailElems[this.page].name = this.name;

                detailElems[this.page].alcoholSlider.value = 1;
                detailElems[this.page].nonalcoholSlider.value = 1;
                detailElems[this.page].updateBody();
                detailElems[this.page].updateEmpty();

                detailElems[this.page].nameElem.textContent = this.nameElem.textContent;
                detailElems[this.page].ingredientBoxElem.style.height = (3.5 * bigVH * Object.keys(this.ingredients).length) + "px";

                detailElems[this.page].bodyElem.classList.remove("shrunk");

                let y = -this.getBoundingClientRect().top + pages[this.page].getBoundingClientRect().top + bigVH;

                pages[this.page].classList.add("noscroll");
                lists[this.page].classList.add("notouch", "transparent");
                this.classList.add("notouch", "transparent");

                detailElems[this.page].style.top = this.offsetTop - bigVH + "px";
                detailElems[this.page].classList.remove("notouch", "transparent");
                detailElems[this.page].style.transform = "translateY(" + y + "px)";
            }
        }
        customElements.define('drink-item', DrinkItem);


        class DrinkDetail extends HTMLElement {
            constructor() {
                super();

                var templateDrinkDetail = document.getElementById("template-drink-detail").content;
                this.appendChild(templateDrinkDetail.cloneNode(true));

                this.expanded = false;
                this.empty = false;
                this.same = false;

                this.page = this.getAttribute('page');

                this.nameElem = this.querySelector('.drink-name');
                this.itemElem = this.querySelector('.drink-item');

                this.bodyElem = this.querySelector('.drink-detail-body');
                this.ingredientBoxElem = this.querySelector('.ingredient-box');

                this.ingredients = {};
                this.ingredientsElem = new Array(40);
                var templateIngredientAmount = document.getElementById("template-ingredient-amount").content;
                for (var i = 0; i < 40; i++) {
                    let item = templateIngredientAmount.cloneNode(true).children[0];
                    this.ingredientsElem[i] = item;
                    this.ingredientBoxElem.append(item);
                }

                this.volume = this.querySelector('.volume-label');
                this.alcohol = this.querySelector('.alcohol-label');
                this.abv = this.querySelector('.abv-label');

                this.alcoholMult = this.querySelector('.alcohol-mult');
                this.alcoholSlider = this.querySelector('.alcohol-slider');
                this.alcoholSlider.oninput = this.updateBody.bind(this);
                this.alcoholSlider.addEventListener('touchstart', this.sliderStart, { passive: true });
                this.alcoholSlider.addEventListener('touchend', this.sliderStop, { passive: true });
                this.alcoholSlider.addEventListener('touchcancel', this.sliderStop, { passive: true });

                this.nonalcoholMult = this.querySelector('.nonalcohol-mult');
                this.nonalcoholSlider = this.querySelector('.nonalcohol-slider');
                this.nonalcoholSlider.oninput = this.updateBody.bind(this);
                this.nonalcoholSlider.addEventListener('touchstart', this.sliderStart, { passive: true });
                this.nonalcoholSlider.addEventListener('touchend', this.sliderStop, { passive: true });
                this.nonalcoholSlider.addEventListener('touchcancel', this.sliderStop, { passive: true });

                this.tubButton = this.querySelector('.tub-button');
                this.basementButton = this.querySelector('.basement-button');

                this.tubButton.onclick = () => {
                    this.detailClick('hottub');
                }
                this.basementButton.onclick = () => {
                    this.detailClick('basement');
                }

                this.onclick = () => {
                    event.stopPropagation();
                    this.collapseDetail();
                };
            }

            sliderStart() {
                pageView.classList.add('noscroll');
            }

            sliderStop() {
                pageView.classList.remove('noscroll');
            }

            addQueue() {
                let msg = {
                    uuid: uuid,
                    type: "queue"
                };
                socket.send(JSON.stringify(msg));
            }

            removeQueue() {
                let msg = {
                    uuid: uuid,
                    type: "remove"
                };
                socket.send(JSON.stringify(msg));
            }

            changeQueue(outlet) {
                queuedDrink.name = this.name;
                queuedDrink.ingredients = {};
                for (let ingredient in this.ingredients) {
                    queuedDrink.ingredients[ingredient] = this.ingredients[ingredient];
                }
                queuedDrink.outlet = outlet;
                if (userState == "INLINE" || userState == "FRONTLINE" || userState == "POURING") {
                    statusDrink.textContent = queuedDrink.name;
                    statusOutlet.textContent = queuedDrink.outlet;
                }
                this.same = true;
            }

            updateBody() {
                this.updateInfo();
                this.updateButtons();
            }

            updateInfo() {
                let alcoholMult = this.alcoholSlider.value;
                let nonalcoholMult = this.nonalcoholSlider.value;
                let totalVolume = 0;
                let alcoholVolume = 0;
                this.same = true;
                if (this.name != queuedDrink.name) {
                    this.same = false;
                }
                let i = 0;
                this.ingredients = {};
                for (let ingredient in drinkElems[this.name].ingredients) {
                    let abv = ingredients[ingredient].abv;
                    let volume = 0;
                    if (abv > 0) {
                        volume = drinkElems[this.name].ingredients[ingredient] * alcoholMult;
                        alcoholVolume += volume * abv;
                    } else {
                        volume = drinkElems[this.name].ingredients[ingredient] * nonalcoholMult;
                    }
                    this.ingredients[ingredient] = volume;
                    if (this.ingredients[ingredient] != queuedDrink.ingredients[ingredient]) {
                        this.same = false;
                    }
                    totalVolume += volume;
                    if (ingredients[ingredient].empty) {
                        this.ingredientsElem[i].textContent = ingredient + ": " + decimal(volume, 2) + " oz (EMPTY)";
                    } else {
                        this.ingredientsElem[i].textContent = ingredient + ": " + decimal(volume, 2) + " oz";
                    }
                    i++;
                }

                this.volume.textContent = "total: " + decimal(totalVolume, 2) + " oz";
                this.alcohol.textContent = "drinks: " + decimal(alcoholVolume / 0.6, 1);
                if (totalVolume > 0) {
                    this.abv.textContent = "ABV: " + decimal(alcoholVolume * 100 / totalVolume, 1) + "%";
                } else {
                    this.abv.textContent = "ABV: 0%";
                }

                this.alcoholMult.textContent = "Alcohol: " + alcoholMult + "x";
                this.nonalcoholMult.textContent = "Non-alcohol: " + nonalcoholMult + "x";
            }

            updateButtons() {
                if (userState == "NOLINE" || userState == "OUTLINE" || userState == "POURING") {
                    this.basementButton.textContent = "Add Basement";
                    this.tubButton.textContent = "Add Hot Tub";
                }
                else if (userState == "INLINE" || userState == "FRONTLINE") {
                    if (this.same && queuedDrink.outlet == 'basement') {
                        this.basementButton.textContent = "Remove Basement";
                        this.tubButton.textContent = "Change Hot Tub";
                    } else if (this.same && queuedDrink.outlet == 'hottub') {
                        this.basementButton.textContent = "Change Basement";
                        this.tubButton.textContent = "Remove Hot Tub";
                    } else {
                        this.basementButton.textContent = "Change Basement";
                        this.tubButton.textContent = "Change Hot Tub";
                    }
                }
            }

            detailClick(outlet) {
                event.stopPropagation();
                if (this.empty) {
                    return;
                }
                if (userState == "NOLINE" || userState == "OUTLINE" || userState == "POURING") {
                    this.changeQueue(outlet);
                    this.addQueue();
                }
                else if (userState == "INLINE" || userState == "FRONTLINE") {
                    if (this.same && queuedDrink.outlet == outlet) {
                        this.removeQueue();
                    } else {
                        this.changeQueue(outlet);
                        this.updateButtons();
                    }
                }
            }

            collapseDetail() {
                let name = this.name;

                this.style.transform = "translateY(0px)";
                this.classList.add("notouch");
                this.bodyElem.classList.add("shrunk");

                pages[this.page].classList.remove("noscroll");
                lists[this.page].classList.remove("notouch", "transparent");

                setTimeout(() => {
                    drinkElems[name].classList.remove("notouch", "transparent");
                    this.classList.add("transparent");
                    this.style.top = "0px";
                    this.expanded = false;
                }, 200);
            }

            updateEmpty() {
                if (drinkElems[this.name].empty && !this.empty) {
                    this.classList.add("drink-empty");
                    this.empty = drinkElems[this.name].empty;
                } else if (!drinkElems[this.name].empty && this.empty) {
                    this.classList.remove("drink-empty");
                    this.empty = drinkElems[this.name].empty;
                }
            }
        }
        customElements.define('drink-detail', DrinkDetail);


        class IngredientItem extends HTMLElement {
            constructor(name) {
                super();

                this.appendChild(templateIngredientItem.content.cloneNode(true));

                this.name = name;
                this.empty = false;
                this.volume = 0;

                this.nameElem = this.querySelector(".ingredient-name");
                this.nameElem.textContent = this.name;

                this.plus = this.querySelector(".ingredient-plus");
                this.minus = this.querySelector(".ingredient-minus");

                this.volumeElem = this.querySelector(".ingredient-volume");
                this.volumeElem.textContent = this.volume + " oz";

                this.plus.onclick = this.ingredientPlus.bind(this);
                this.minus.onclick = this.ingredientMinus.bind(this);

                // this.plus.addEventListener('touchstart', ()=>{
                //     this.ingredientPlus();
                //     clearInterval(this.buttonInterval);
                //     this.buttonInterval = setInterval(()=>{
                //         this.ingredientPlus();
                //     }, 100);
                // }, { passive: true });
                // this.plus.addEventListener('touchend', ()=>{
                //     clearInterval(this.buttonInterval);
                // }, { passive: true });
                // this.plus.addEventListener('touchcancel', ()=>{
                //     clearInterval(this.buttonInterval);
                // }, { passive: true });

                // this.minus.addEventListener('touchstart', ()=>{
                //     this.ingredientMinus();
                //     clearInterval(this.buttonInterval);
                //     this.buttonInterval = setInterval(()=>{
                //         this.ingredientMinus();
                //     }, 100);
                // }, { passive: true });
                // this.minus.addEventListener('touchend', ()=>{
                //     clearInterval(this.buttonInterval);
                // }, { passive: true });
                // this.minus.addEventListener('touchcancel', ()=>{
                //     clearInterval(this.buttonInterval);
                // }, { passive: true });

                // this.buttonInterval = null;
            }

            updateEmpty() {
                if (ingredients[this.name].empty && !this.empty) {
                    this.classList.add("drink-empty");
                    this.empty = ingredients[this.name].empty;
                } else if (!ingredients[this.name].empty && this.empty) {
                    this.classList.remove("drink-empty");
                    this.empty = ingredients[this.name].empty;
                }
            }

            ingredientPlus() {
                this.ingredientChange(Math.min(this.volume + 0.1, 8));
            }

            ingredientMinus() {
                this.ingredientChange(Math.max(this.volume - 0.1, 0));
            }

            ingredientChange(volume) {
                if (!ingredients[this.name].empty) {
                    this.volume = decimal(volume, 1);
                } else {
                    this.volume = 0;
                }
                this.volumeElem.textContent = this.volume + " oz";

                if (this.volume == 0) {
                    delete drinkElems['Custom Drink'].ingredients[this.name];
                } else {
                    drinkElems['Custom Drink'].ingredients[this.name] = this.volume;
                }

                drinkElems['Custom Drink'].updateEmpty();
                drinkElems['Custom Drink'].updateIngredients();
            }

            updateCustomDrink() {
                let drink
                for (let name in ingredients) {
                    if (this.volume > 0) {

                    }
                }
            }
        }
        customElements.define('ingredient-item', IngredientItem);



        function statusClick() {
            if (userState == "FRONTLINE") {
                let msg = {
                    uuid: uuid,
                    type: "pour",
                    name: queuedDrink.name,
                    ingredients: queuedDrink.ingredients,
                    outlet: queuedDrink.outlet
                };
                socket.send(JSON.stringify(msg));
            } else if (userState == "POURING") {
                let msg = {
                    uuid: uuid,
                    type: "cancel"
                };
                socket.send(JSON.stringify(msg));
            }
        }

        function decimal(num, place) {
            return Math.round(num * Math.pow(10, place)) / Math.pow(10, place)
        }

        function setPage(page) {
            pages[page].scrollIntoView({ behavior: "smooth" });
        }

        function setTheme(x, store) {
            theme = x;
            if (theme == "light") {
                userDarkButton.classList.remove("active");
                userLightButton.classList.add("active");
                document.documentElement.style.setProperty('--panel-color', "hsla(0, 0%, 100%, 10%)");
            } else if (theme == "dark") {
                userLightButton.classList.remove("active");
                userDarkButton.classList.add("active");
                document.documentElement.style.setProperty('--panel-color', "hsla(0, 0%, 0%, 35%)");
            }
            if (store) {
                localStorage.setItem('theme', theme);
            }
        }

        /////////////////////////////////////////

        var drinksTab = document.getElementById("drinks-tab");
        drinksTab.onclick = () => { setPage('drinks') };

        var ingredientsTab = document.getElementById("ingredients-tab");
        ingredientsTab.onclick = () => { setPage('ingredients') };

        var userTab = document.getElementById("user-tab");
        userTab.onclick = () => { setPage('user') };

        var pageView = document.getElementById("page-view");

        var tabBar = document.getElementById("tab-bar");

        var drinks = {};
        var ingredients = {};

        var pages = {};
        var lists = {};

        /////////////////////////////////////////

        pages['drinks'] = document.getElementById("drinks-page");
        lists['drinks'] = document.getElementById("drink-list");
        var drinkElems = {};

        var templateDrinkItem = document.getElementById("template-drink-item");
        var templateIngredientItem = document.getElementById("template-ingredient-item");

        var detailElems = {};
        detailElems['drinks'] = document.getElementById("detail-drinks");
        detailElems['ingredients'] = document.getElementById("detail-ingredients");

        var userState = "";
        var makerState = "";

        /////////////////////////////////////////

        pages['ingredients'] = document.getElementById("ingredients-page");
        lists['ingredients'] = document.getElementById("ingredient-list");
        var ingredientElems = {};

        var ingredientTemplate = document.getElementById("template-ingredient-item");

        drinkElems['Custom Drink'] = new DrinkItem('Custom Drink', 'ingredients');
        pages['ingredients'].append(drinkElems['Custom Drink']);

        /////////////////////////////////////////

        pages['user'] = document.getElementById("user-page");

        var userNameInput = document.getElementById("user-name-input");
        var userWeightInput = document.getElementById("user-weight-input");
        var userMaleButton = document.getElementById("user-male-button");
        var userFemaleButton = document.getElementById("user-female-button");

        var userDrinks = document.getElementById("user-drinks-value");
        var userBAC = document.getElementById("user-bac-value");

        userMaleButton.onclick = function () {
            userSex = "male";
            userFemaleButton.classList.remove("active");
            userMaleButton.classList.add("active");
        }

        userFemaleButton.onclick = function () {
            userSex = "female";
            userMaleButton.classList.remove("active");
            userFemaleButton.classList.add("active");
        }

        var userUpdate = document.getElementById("user-update");
        userUpdate.onclick = function () {
            var msg = {
                uuid: uuid,
                type: "user",
                name: userNameInput.value,
                weight: userWeightInput.value,
                sex: userSex
            };
            socket.send(JSON.stringify(msg));
        }

        var userDarkButton = document.getElementById("user-dark-button");
        var userLightButton = document.getElementById("user-light-button");

        userDarkButton.onclick = function () {
            setTheme('dark', true);
        }

        userLightButton.onclick = function () {
            setTheme('light', true);
        }

        var userSex = "";

        var theme = localStorage.getItem('theme');
        if (theme == null) {
            theme = "light"
            localStorage.setItem('theme', theme);
        }
        setTheme(theme, false);

        ////////////////////////////////////////////////////////////////

        var statusBase = document.getElementById("status-bar");

        var statusQueue = document.getElementById("status-queue");
        var statusState = document.getElementById("status-state");
        var statusConnection = document.getElementById("status-connection");

        var statusDrink = document.getElementById("status-drink");
        var statusOutlet = document.getElementById("status-outlet");

        var statusButton = document.getElementById("status-button");
        statusButton.onclick = statusClick;

        var statusTimer = null;
        var statusTime = 0;

        var queuedDrink = {
            name: "",
            ingredients: {},
            outlet: ""
        };

        ////////////////////////////////////////////////////////////////

        pageView.onscroll = pageScrolled;

        function pageScrolled() {
            let scroll = pageView.scrollLeft;
            let x = pageView.scrollLeft / windowWidth * 100;
            tabBar.style.transform = "translateX(" + x + "%)";

            if (scroll < windowWidth * 0.5) {
                if (currentPage != 0) {
                    currentPage = 0;
                    drinksTab.classList.add("selected");
                    ingredientsTab.classList.remove("selected");
                    userTab.classList.remove("selected");
                }
            } else if (scroll < windowWidth * 1.5) {
                if (currentPage != 1) {
                    currentPage = 1;
                    drinksTab.classList.remove("selected");
                    ingredientsTab.classList.add("selected");
                    userTab.classList.remove("selected");
                }
            } else {
                if (currentPage != 2) {
                    currentPage = 2;
                    drinksTab.classList.remove("selected");
                    ingredientsTab.classList.remove("selected");
                    userTab.classList.add("selected");
                }
            }
        };

        var currentPage = 0;

        ////////////////////////////////////////////////////////////////

        var socket = null;
        var socketConnected = false;
        var socketAttempts = 0;

        var uuid = localStorage.getItem('uuid');
        if (uuid == null) {

            let array = new Uint8Array(16);
            self.crypto.getRandomValues(array);
            var uuid = "";
            for (let i = 0; i < 16; i++) {
                if (i == 4 || i == 6 || i == 8 || i == 10) {
                    uuid += "-";
                }
                uuid += array[i].toString(16);
            };

            localStorage.setItem('uuid', uuid)
            console.log("new user: " + uuid);
        }

        const windowWidth = window.innerWidth;
        const windowHeight = window.innerHeight;

        const smallVH = windowHeight * 0.01;
        const bigVH = document.getElementById('ruler').clientHeight * 0.02;

        document.documentElement.style.setProperty('--vh', (windowHeight * 0.01) + "px");

        socketInit();

        ///////////////////////////////////////////////////////////////////////

        const drawParticlesVS = `#version 300 es
            in vec2 position;
            in vec2 velocity;
            in vec4 color;

            uniform float ratio;
            uniform float pointSize;
            uniform vec2 dimensions;
            uniform float time;
            uniform vec2 bounds;

            out vec2 v_center;
            out vec4 v_color;

            void main() {
                vec2 farPosition = position + velocity*time + bounds*0.5;
                vec2 modPosition = mod(mod(farPosition, bounds) + bounds, bounds) - bounds*0.5;

                gl_Position = vec4(modPosition.x, modPosition.y*ratio, 1, 1);
                gl_PointSize = pointSize;
                
                v_center = vec2((gl_Position.x + 1.0)*dimensions.x, (gl_Position.y + 1.0)*dimensions.y);
                v_color = color;
            }
            `;

        const drawParticlesFS = `#version 300 es
            precision highp float;
            out vec4 outColor;

            uniform float deviation2;

            in vec2 v_center;
            in vec4 v_color;

            void main() {
                float amplitude = 0.4;
                vec2 diff = gl_FragCoord.xy - v_center;
                float length2 = (diff.x*diff.x) + (diff.y*diff.y);
                float intensity = amplitude * pow(2.71828, -0.5*(length2 / deviation2));

                outColor = vec4(v_color.rgb, intensity);
            }
            `;

        // Get A WebGL context
        /** @type {HTMLCanvasElement} */
        const canvas = document.querySelector("#canvas");
        const gl = canvas.getContext("webgl2");

        gl.canvas.width = windowWidth;
        gl.canvas.height = windowHeight;

        const flareProgram = gl.createProgram();

        const vshader = gl.createShader(gl.VERTEX_SHADER);
        const fshader = gl.createShader(gl.FRAGMENT_SHADER);
        gl.shaderSource(vshader, drawParticlesVS);
        gl.shaderSource(fshader, drawParticlesFS);
        gl.compileShader(vshader);
        gl.compileShader(fshader);
        gl.attachShader(flareProgram, vshader);
        gl.attachShader(flareProgram, fshader);
        gl.linkProgram(flareProgram);

        const positionLoc = gl.getAttribLocation(flareProgram, 'position');
        const velocityLoc = gl.getAttribLocation(flareProgram, 'velocity');
        const colorLoc = gl.getAttribLocation(flareProgram, 'color');

        const ratioLoc = gl.getUniformLocation(flareProgram, 'ratio');
        const timeLoc = gl.getUniformLocation(flareProgram, 'time');
        const boundsLoc = gl.getUniformLocation(flareProgram, 'bounds');
        const deviationLoc = gl.getUniformLocation(flareProgram, 'deviation2');
        const pointLoc = gl.getUniformLocation(flareProgram, 'pointSize');
        const dimensionsLoc = gl.getUniformLocation(flareProgram, 'dimensions');



        const flareCount = 100;
        const flareSize = 0.8;
        const flareSpeed = 0.2;

        const colorOptions = [
            0, 255, 213,
            0, 170, 255,
            0, 42, 255,
            85, 0, 255,
            212, 0, 255,
            255, 0, 170,
        ];

        const ratioWH = gl.canvas.width / gl.canvas.height;
        const ratioHW = 1 / ratioWH;



        const buffer = new ArrayBuffer(flareCount * 28);
        const dv = new DataView(buffer);

        for (let i = 0; i < flareCount; i++) {
            let x = (Math.random() * 2 - 1) * (1 + flareSize);
            let y = (Math.random() * 2 - 1) * (ratioHW + flareSize);
            dv.setFloat32(28 * i, x, true);
            dv.setFloat32(28 * i + 4, y, true);

            let num = Math.random() * Math.PI * 2;
            dv.setFloat32(28 * i + 8, Math.cos(num) * flareSpeed, true);
            dv.setFloat32(28 * i + 12, Math.sin(num) * flareSpeed, true);

            num = i % (colorOptions.length / 3);
            dv.setFloat32(28 * i + 16, colorOptions[num * 3] / 255.0 * 0.4, true);
            dv.setFloat32(28 * i + 20, colorOptions[num * 3 + 1] / 255.0 * 0.4, true);
            dv.setFloat32(28 * i + 24, colorOptions[num * 3 + 2] / 255.0 * 0.4, true);
        }



        const flareVertexArray = gl.createVertexArray();
        gl.bindVertexArray(flareVertexArray);

        const vbo = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, vbo);
        gl.bufferData(gl.ARRAY_BUFFER, buffer, gl.STATIC_DRAW);

        gl.vertexAttribPointer(positionLoc, 2, gl.FLOAT, false, 28, 0);
        gl.enableVertexAttribArray(positionLoc);

        gl.vertexAttribPointer(velocityLoc, 2, gl.FLOAT, false, 28, 8);
        gl.enableVertexAttribArray(velocityLoc);

        gl.vertexAttribPointer(colorLoc, 3, gl.FLOAT, false, 28, 16);
        gl.enableVertexAttribArray(colorLoc);



        gl.enable(gl.BLEND);
        gl.blendFunc(gl.SRC_ALPHA_SATURATE, gl.ONE);

        gl.useProgram(flareProgram);
        gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);

        gl.uniform2f(boundsLoc, 2 + 2 * flareSize, 2 * ratioHW + 2 * flareSize);
        gl.uniform1f(ratioLoc, ratioWH);
        gl.uniform1f(pointLoc, flareSize * gl.canvas.width);
        gl.uniform1f(deviationLoc, Math.pow(flareSize * gl.canvas.width * 0.185, 2));
        gl.uniform2f(dimensionsLoc, gl.canvas.width * 0.5, gl.canvas.height * 0.5);



        function render(time) {

            gl.clear(gl.COLOR_BUFFER_BIT);

            gl.uniform1f(timeLoc, time * 0.001);
            gl.drawArrays(gl.POINTS, 0, flareCount);

            requestAnimationFrame(render);
        }
        requestAnimationFrame(render);

    </script>

    <style>
        html{
            background-color: red;
        }
        :root {
            --panel-color: hsla(0, 0%, 100%, 10%);
            --hue-a: 170;
            --hue-b: 200;
            --hue-c: 230;
            --hue-d: 260;
            --hue-e: 290;
            --hue-f: 320;
            --vh: 1vh;
            background-color: red;
        }

        #ruler {
            position: absolute;
            height: 50vh;
            visibility: hidden;
        }

        body {
            background-color: red;
            color-scheme: dark;
            height: calc(var(--vh) * 100);
            margin: 0;
            padding: 0;
            touch-action: manipulation;
            user-select: none;
            font-family: 'Roboto', sans-serif;
            font-size: 0;
            color: white;
        }

        #canvas {
            top: 0;
            left: 0;
            position: fixed;
            background-color: black;
        }

        #header {
            height: 8%;
            width: 100%;
            position: fixed;
            top: 0;
            z-index: 10;
            box-shadow: 0 0 16px 2px hsla(0, 0%, 0%, 0.5);
        }

        .tab {
            position: absolute;
            background-color: var(--panel-color);
            box-sizing: border-box;
            font-size: 3vh;
            height: 100%;
            top: 0;
            width: calc(100%/3);
            line-height: 250%;
            overflow: hidden;
            text-align: center;
        }

        .tab:active {
            opacity: 50%;
        }

        .tab.selected {
            font-weight: bold;
        }

        #tab-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 0.5vh;
            width: calc(100%/3);
            background-color: hsl(var(--hue-f), 80%, 35%);
            will-change: transform;
        }

        #drinks-tab {
            left: 0%;
        }

        #ingredients-tab {
            left: calc(100%/3);
        }

        #user-tab {
            right: 0%;
        }

        #page-view {
            height: 82%;
            width: 100%;
            position: absolute;
            /* opacity: 0; */
            top: 8%;
            overflow-y: hidden;
            scroll-behavior: smooth;
            scroll-snap-type: x mandatory;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        #page-view::-webkit-scrollbar {
            display: none;
        }

        #drinks-page {
            height: 100%;
            width: 100%;
            top: 0%;
            left: 0%;
            position: absolute;
            overflow-y: auto;
            scroll-snap-align: start;
            scroll-snap-stop: always;
        }

        #drink-list {
            position: absolute;
            top: 0%;
            left: 0%;
            width: 100%;
            padding: 0;
            transition: opacity 200ms linear;
            will-change: opacity;
        }

        drink-detail {
            display: block;
            position: absolute;
            top: 0%;
            left: 0%;
            height: 100%;
            width: 100%;
            padding: 0 1vh 0 1vh;
            box-sizing: border-box;
            transition: transform 200ms;
            will-change: transform, opacity;
        }

        #ingredients-page {
            height: 100%;
            width: 100%;
            top: 0%;
            left: 100%;
            position: absolute;
            overflow-y: auto;
            scroll-snap-align: start;
            scroll-snap-stop: always;
        }

        #ingredient-list {
            position: absolute;
            top: 0%;
            left: 0%;
            width: 100%;
            height: calc(100% - 11vh);
            overflow-y: auto;
            transition: opacity 200ms linear;
            will-change: opacity;
        }

        #user-page {
            height: 100%;
            width: 100%;
            top: 0%;
            left: 200%;
            position: absolute;
            overflow-y: auto;
            scroll-snap-align: start;
            scroll-snap-stop: always;
        }

        #user-name-label {
            position: absolute;
            left: 10%;
            top: 8%;
            width: 30%;
            height: 8%;
            line-height: 250%;
            background-color: hsl(0deg 0% 100% / 0%);
            font-size: 2.5vh;
        }

        #user-name-input {
            position: absolute;
            right: 10%;
            top: 8%;
            width: 45%;
            height: 8%;
            background-color: var(--panel-color);
            border: none;
            font-size: 2.5vh;
            border-bottom: solid 0.2vh hsl(0deg 0% 100% / 50%);
            border-radius: 1vh;
            text-align: center;
            padding: 0;
            margin: 0;
            font-family: 'Roboto', sans-serif;
        }

        #user-weight-label {
            position: absolute;
            left: 10%;
            top: 20%;
            width: 30%;
            height: 8%;
            line-height: 250%;
            background-color: hsl(0deg 0% 100% / 0%);
            font-size: 2.5vh;
        }

        #user-weight-input {
            position: absolute;
            right: 10%;
            top: 20%;
            width: 45%;
            height: 8%;
            background-color: var(--panel-color);
            border: none;
            font-size: 2.5vh;
            border-bottom: solid 0.2vh hsl(0deg 0% 100% / 50%);
            border-radius: 1vh;
            text-align: center;
            padding: 0;
            margin: 0;
            font-family: 'Roboto', sans-serif;
        }

        #user-sex-label {
            position: absolute;
            left: 10%;
            top: 32%;
            width: 30%;
            height: 8%;
            line-height: 250%;
            background-color: hsl(0deg 0% 100% / 0%);
            font-size: 2.5vh;
        }

        #user-male-button {
            position: absolute;
            right: 35%;
            top: 32%;
            width: 20%;
            height: 8%;
            border-radius: 1vh;
            background-color: var(--panel-color);
            line-height: 250%;
            font-size: 2.5vh;
            text-align: center;
        }

        #user-female-button {
            position: absolute;
            right: 10%;
            top: 32%;
            width: 20%;
            height: 8%;
            border-radius: 1vh;
            background-color: var(--panel-color);
            line-height: 250%;
            font-size: 2.5vh;
            text-align: center;
        }

        #user-male-button.active {
            background-color: hsl(var(--hue-a), 80%, 27%);
        }

        #user-female-button.active {
            background-color: hsl(var(--hue-a), 80%, 27%);
        }

        #user-drinks-label {
            position: absolute;
            left: 10%;
            top: 48%;
            width: 30%;
            background-color: hsl(0deg 0% 100% / 0%);
            font-size: 2.5vh;
        }

        #user-drinks-value {
            position: absolute;
            right: 10%;
            top: 48%;
            width: 45%;
            background-color: hsl(0deg 0% 100% / 0%);
            font-size: 2.5vh;
        }

        #user-bac-label {
            position: absolute;
            left: 10%;
            top: 54%;
            width: 30%;
            background-color: hsl(0deg 0% 100% / 0%);
            font-size: 2.5vh;
        }

        #user-bac-value {
            position: absolute;
            right: 10%;
            top: 54%;
            width: 45%;
            background-color: hsl(0deg 0% 100% / 0%);
            font-size: 2.5vh;
        }

        #user-update {
            position: absolute;
            left: 30%;
            top: 64%;
            width: 40%;
            height: 10%;
            font-size: 2.5vh;
            background-color: hsl(var(--hue-f), 80%, 27%);
            border-radius: 1vh;
            text-align: center;
            line-height: 300%;
            box-shadow: hsl(0, 0%, 0%) 0 0 2px;
            /* will-change: transform, opacity; */
        }

        #user-update:active {
            transform: scale(0.97);
            opacity: 50%;
        }

        #user-theme-label {
            position: absolute;
            left: 10%;
            top: 85%;
            width: 30%;
            height: 8%;
            line-height: 250%;
            background-color: hsl(0deg 0% 100% / 0%);
            font-size: 2.5vh;
        }

        #user-dark-button {
            position: absolute;
            right: 35%;
            top: 85%;
            width: 20%;
            height: 8%;
            border-radius: 1vh;
            background-color: var(--panel-color);
            line-height: 250%;
            font-size: 2.5vh;
            text-align: center;
        }

        #user-light-button {
            position: absolute;
            right: 10%;
            top: 85%;
            width: 20%;
            height: 8%;
            border-radius: 1vh;
            background-color: var(--panel-color);
            line-height: 250%;
            font-size: 2.5vh;
            text-align: center;
        }

        #user-dark-button.active {
            background-color: hsl(var(--hue-e), 80%, 27%);
        }

        #user-light-button.active {
            background-color: hsl(var(--hue-e), 80%, 27%);
        }

        ingredient-item {
            display: block;
            position: relative;
            height: 10vh;
            margin: 1vh;
        }

        .ingredient-name {
            position: absolute;
            width: 40%;
            height: 3vh;
            top: 3.5vh;
            left: 5%;
            line-height: 100%;
            font-size: 2.5vh;
        }

        .ingredient-volume {
            position: absolute;
            width: 20%;
            height: 2.5vh;
            top: 3.75vh;
            left: 60%;
            line-height: 100%;
            font-size: 2.5vh;
            text-align: center;
        }

        .ingredient-button {
            position: absolute;
            top: 1vh;
            width: 8vh;
            height: 8vh;
            line-height: 8vh;
            font-size: 0vh;
            border-radius: 1vh;
            text-align: center;
            box-shadow: hsl(0deg 0% 0%) 0 0 2px;
        }

        .ingredient-button:active {
            transform: scale(0.97);
            opacity: 50%;
        }

        .ingredient-plus {
            right: 5%;
            background-color: hsl(var(--hue-b), 80%, 27%);
        }

        .ingredient-plus:after {
            content: "\002B";
            font-size: 6vh;
        }

        .ingredient-minus {
            right: 40%;
            background-color: hsl(var(--hue-e), 80%, 27%);
        }

        .ingredient-minus:after {
            content: "\2212";
            font-size: 6vh;
        }

        .ingredient-empty {
            opacity: 40%;
        }

        .ingredient-empty .ingredient-name {
            text-decoration: line-through;
        }

        .drink-detail-body {
            position: relative;
            transition: transform 200ms;
            height: calc(100% - 12vh);
            background-color: var(--panel-color);
            margin: 0;
            border-radius: 0vh 0vh 1vh 1vh;
            transform-origin: 50% 0%;
            will-change: transform;
        }

        drink-item {
            display: block;
            position: relative;
            background-color: var(--panel-color);
            height: 10vh;
            border-radius: 1vh;
            margin: 1vh;
        }

        #ingredients-page>drink-item {
            top: calc(100% - 12vh);
        }

        .drink-empty {
            opacity: 40%;
        }

        .drink-empty .drink-name {
            text-decoration: line-through;
        }

        .drink-item {
            position: relative;
            background-color: var(--panel-color);
            height: 10vh;
            border-radius: 1vh;
            margin: 1vh 0 1vh 0;
            border-radius: 1vh 1vh 0 0;
            margin: 1vh 0 0 0;
        }

        .drink-name {
            position: absolute;
            width: 55%;
            height: 32%;
            top: 34%;
            left: 5%;
            line-height: 100%;
            font-size: 3vh;
            white-space: nowrap;
            overflow: hidden;
        }

        .close {
            position: absolute;
            width: 4vh;
            height: 4vh;
            top: 34%;
            right: 5%;
            text-align: center;
        }

        .close:after {
            content: "\2573";
            font-size: 2vh;
        }

        .arrow {
            position: absolute;
            width: 4vh;
            height: 4vh;
            top: 25%;
            right: 5%;
            text-align: center;
            transform: rotateZ(-45deg);
        }

        .arrow:after {
            content: "\221F";
            font-size: 3vh;
        }

        .ingredient-summary {
            position: absolute;
            width: 25%;
            height: 18%;
            top: 41%;
            left: 60%;
            line-height: 100%;
            font-size: 1.7vh;
            text-overflow: clip;
            overflow: hidden;
            white-space: nowrap;
            transition: transform 200ms;
            /* will-change: opacity; */
        }

        .ingredient-wrapper {
            position: absolute;
            font-size: 2vh;
            height: 25%;
            left: 10%;
            width: 80%;
            overflow-y: auto;
        }

        .ingredient-box {
            position: absolute;
            left: 0%;
            width: 100%;
            overflow-y: hidden;
        }

        .ingredient-amount {
            line-height: 140%;
            font-size: 2.5vh;
            height: 3.5vh;
            overflow-x: hidden;
        }

        .item-button {
            position: absolute;
            font-size: 2vh;
            height: 10%;
            bottom: 5%;
            line-height: 340%;
            width: 42%;
            overflow: hidden;
            border-radius: 1vh;
            text-align: center;
            box-shadow: hsl(0, 0%, 0%) 0 0 2px;
            /* will-change: transform, opacity; */
        }

        .tub-button {
            left: 5%;
            background-color: hsl(var(--hue-e), 80%, 27%);
        }

        .basement-button {
            right: 5%;
            background-color: hsl(var(--hue-b), 80%, 27%);
        }

        .item-button:active {
            transform: scale(0.97);
            opacity: 50%;
        }

        #status {
            background-color: var(--panel-color);
            text-align: center;
            font-size: 3vh;
            height: 10%;
            width: 100%;
            position: fixed;
            bottom: 0;
            box-shadow: 0 0 16px 2px hsla(0, 0%, 0%, 0.5);
        }

        #status-button {
            position: absolute;
            font-size: 2.5vh;
            height: 78%;
            top: 11%;
            right: 2%;
            width: 30%;
            line-height: 280%;
            overflow: hidden;
            border-radius: 1vh;
            text-align: center;
            box-shadow: hsl(0, 0%, 0%) 0 0 2px;
            will-change: opacity;
            background-color: hsl(var(--hue-a), 80%, 27%);
        }

        #status-button.pour {
            animation: flash 200ms 0s infinite;
            animation-direction: alternate;
            background-color: hsl(var(--hue-a), 80%, 27%);
        }

        #status-button.cancel {
            background-color: hsl(var(--hue-f), 80%, 27%);
        }

        #status-button:active {
            transform: scale(0.97);
            opacity: 50%;
        }

        #status-queue {
            position: absolute;
            height: 18%;
            line-height: 100%;
            width: 25%;
            text-align: left;
            top: 10%;
            left: 2%;
            font-size: 2vh;
        }

        #status-state {
            position: absolute;
            height: 18%;
            line-height: 100%;
            width: 25%;
            text-align: left;
            bottom: 41%;
            left: 2%;
            font-size: 2vh;
        }

        #status-connection {
            position: absolute;
            height: 18%;
            line-height: 100%;
            width: 25%;
            text-align: left;
            bottom: 10%;
            left: 2%;
            font-size: 2vh;
            font-weight: bold;
        }

        #status-drink {
            position: absolute;
            height: 18%;
            line-height: 100%;
            width: 34%;
            text-align: left;
            top: 23%;
            left: 34%;
            font-size: 2vh;
        }

        #status-outlet {
            position: absolute;
            height: 18%;
            line-height: 100%;
            width: 34%;
            text-align: left;
            bottom: 23%;
            left: 34%;
            font-size: 2vh;
        }

        #status-bar {
            position: absolute;
            top: 0;
            width: 100%;
            height: 5%;
            transform-origin: 0% 50%;
            transition: transform 1000ms linear;
            will-change: transform, opacity;
        }

        .bar-timer {
            animation: flash 200ms 0s infinite;
            animation-direction: alternate;
            background-color: hsl(var(--hue-a), 85%, 40%);
        }

        .bar-progress {
            background-color: hsl(var(--hue-f), 85%, 40%);
        }

        .volume-label {
            position: absolute;
            top: 30%;
            left: 10%;
            width: 35%;
            height: 4%;
            line-height: 140%;
            font-size: 2.5vh;
            overflow: hidden;
            white-space: nowrap;
        }

        .alcohol-label {
            position: absolute;
            top: 35%;
            left: 10%;
            width: 35%;
            height: 4%;
            line-height: 140%;
            font-size: 2.5vh;
            overflow: hidden;
            white-space: nowrap;
        }

        .abv-label {
            position: absolute;
            top: 40%;
            left: 10%;
            width: 35%;
            height: 4%;
            line-height: 140%;
            font-size: 2.5vh;
            overflow: hidden;
            white-space: nowrap;
        }

        .alcohol-mult {
            position: absolute;
            top: 50%;
            left: 36%;
            width: 28%;
            height: 4%;
            line-height: 140%;
            font-size: 2.5vh;
            overflow: hidden;
            white-space: nowrap;
        }

        .nonalcohol-mult {
            position: absolute;
            top: 65%;
            left: 31%;
            width: 38%;
            height: 4%;
            line-height: 140%;
            font-size: 2.5vh;
            overflow: hidden;
            white-space: nowrap;
        }

        .alcohol-slider {
            position: absolute;
            top: 55%;
            left: 5%;
            width: 90%;
            height: 4vh;
            appearance: none;
            background-color: hsl(0deg 0% 100% / 5%);
            border-radius: 2vh;
        }

        .alcohol-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 4vh;
            height: 4vh;
            background: hsl(var(--hue-a), 80%, 27%);
            border-radius: 2vh;
            cursor: pointer;
        }

        .nonalcohol-slider {
            position: absolute;
            top: 70%;
            left: 5%;
            width: 90%;
            height: 4vh;
            appearance: none;
            background-color: hsl(0deg 0% 100% / 5%);
            border-radius: 2vh;
        }

        .nonalcohol-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 4vh;
            height: 4vh;
            background: hsl(var(--hue-a), 80%, 27%);
            border-radius: 2vh;
            cursor: pointer;
        }

        .shrunk {
            transform: scaleY(0);
        }

        .transparent {
            opacity: 0%;
        }

        .hidden {
            visibility: hidden;
        }

        .notouch {
            pointer-events: none;
        }

        #drinks-page.noscroll {
            overflow-y: hidden;
        }

        #page-view.noscroll {
            overflow-x: hidden;
        }

        .grey {
            opacity: 25%;
        }

        /* Animation Keyframes*/
        @keyframes flash {
            from {
                opacity: 100%;
            }

            to {
                opacity: 50%;
            }
        }
    </style>
</head>



<body>
    <template id="template-drink-item">
        <div class="drink-name"></div>
        <div class="ingredient-summary"></div>
        <div class="arrow"></div>
    </template>

    <template id="template-drink-detail">
        <div class="drink-item">
            <div class="drink-name"></div>
            <div class="close"></div>
        </div>
        <div class="drink-detail-body shrunk">
            <div class="ingredient-wrapper">
                <div class="ingredient-box"></div>
            </div>

            <div class="volume-label">Volume: </div>
            <div class="alcohol-label">Drinks: </div>
            <div class="abv-label">ABV: </div>

            <div class="alcohol-mult">Alcohol: </div>
            <input class="alcohol-slider" type="range" min="0" max="2" step="0.25" defaultValue="1">
            <div class="nonalcohol-mult">Non-alcohol: </div>
            <input class="nonalcohol-slider" type="range" min="0" max="2" step="0.25" defaultValue="1">

            <div class="tub-button item-button">Pour Hot Tub</div>
            <div class="basement-button item-button">Pour Basement</div>
        </div>
    </template>

    <template id="template-ingredient-amount">
        <div class="ingredient-amount"></div>
    </template>

    <template id="template-ingredient-item">
        <div class="ingredient-name"></div>
        <div class="ingredient-button ingredient-minus"></div>
        <div class="ingredient-volume"></div>
        <div class="ingredient-button ingredient-plus"></div>
    </template>

    <div id="ruler"></div>

    <div id="background">

    </div>

    <canvas id="canvas"></canvas>

    <div id="header">
        <div id="drinks-tab" class="tab selected">Drinks</div>
        <div id="ingredients-tab" class="tab">Custom</div>
        <div id="user-tab" class="tab">User</div>
        <div id="tab-bar"></div>
    </div>
    <div id="page-view">
        <div id="drinks-page">
            <div id="drink-list">

            </div>
            <drink-detail page="drinks" id="detail-drinks" class="notouch transparent"></drink-detail>
        </div>
        <div id="ingredients-page">
            <div id="ingredient-list"></div>
            <drink-detail page="ingredients" id="detail-ingredients" class="notouch transparent"></drink-detail>
        </div>
        <div id="user-page">
            <div id="user-name-label">Name: </div>
            <input id="user-name-input" type="text">

            <div id="user-weight-label">Weight (lb): </div>
            <input id="user-weight-input" type="number" steps="1">

            <div id="user-sex-label">Sex: </div>
            <div id="user-male-button">Male</div>
            <div id="user-female-button">Female</div>

            <div id="user-drinks-label">Drinks: </div>
            <div id="user-drinks-value"></div>
            <div id="user-bac-label">BAC: </div>
            <div id="user-bac-value"></div>

            <div id="user-update">Update</div>

            <div id="user-theme-label">Theme: </div>
            <div id="user-dark-button">Dark</div>
            <div id="user-light-button">Light</div>
        </div>
    </div>
    <div id="status">
        <div id="status-bar"></div>

        <div id="status-queue"></div>
        <div id="status-state"></div>
        <div id="status-connection" class="disconnected"></div>

        <div id="status-drink"></div>
        <div id="status-outlet"></div>

        <div id="status-button">Pour</div>
    </div>
</body>

</html>